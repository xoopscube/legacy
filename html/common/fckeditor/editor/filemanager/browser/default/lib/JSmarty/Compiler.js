JSmarty.Compiler=function(z){var d=JSmarty.Classes.Buffer;var H=JSmarty.Compiler.Context;var G=JSmarty.Compiler;var j=z.left_delimiter;var x=z.right_delimiter;var a=/\r?\n/g;var s=RegExp(j+"\\/(.*?)"+x,"g");var C=RegExp(j+"[^"+x+"]*"+x,"g");var Z=RegExp(G.VALSYMBL,"g");var k=RegExp(G.VALSYMBL+"smarty.","g");function o(D,R){switch(R){case "pre":D=D.replace(a,"\\n");break;case "post":D=D.replace(k,"$.$");D=D.replace(Z,"$v.");break;}return D;}function S(){s.compile(j+"\\/(.*?)"+x,"g");C.compile(j+"[^"+x+"]*"+x,"g");}function W(){var R=false;if(j!=z.left_delimiter){R=true;j=z.left_delimiter;}if(x!=z.right_delimiter){R=true;x=z.right_delimiter;}return R;}this.execute=function(R){var h=new d();var q=new H();var u,A,D,w,i,y,P=0;var B=j.length,X=-x.length;if(W()){S();}q.set("ldelim",z.left_delimiter);q.set("rdelim",z.right_delimiter);R=o(R,"pre");h.append("var Buffer = JSmarty.Classes.Buffer;");h.append("var $v = $.$vars, $b = new Buffer();");w=s;while((D=w.exec(R))!=null){q.addElement("block",D[1]);}w=C;while((D=w.exec(R))!=null){y=D[0];i=R.indexOf(y,P);u=G.newString(R.slice(P,i),q);h.append(u.prefix(),u.toString(),u.suffix());A=G.newModule(y.slice(B,X),q);h.append(A.prefix(),A.toString(),A.suffix());P=i+y.length;}u=G.newString(R.slice(P),q);h.append(u.prefix(),u.toString(),u.suffix(),"return $b.toString();");return o(h.toString(),"post");};};JSmarty.Compiler.define=function(R,S){var C,z,Z,a,x=this[R];for(C in S){a=S[C];z=function(k){this.text=k;};z.prototype=new x();z.prototype.parent=x.prototype;for(Z in a){z.prototype[Z]=a[Z];}this[C]=z;}};JSmarty.Compiler.newString=function(Z,k){var o;o=(k.isPlain())?new this.Plains(Z):new this.String(Z);o.parse(k);return o;};JSmarty.Compiler.newModule=function(z,R){var C,k,o,a,d=z.slice(0,1);var x=0,Z=k=-1,S=R.isPlain();switch(d){case "*":C=new this.String();break;case "#":C=new this.String();break;case "\"":case "'":do{x=z.indexOf(d,x+1);}while(z.charAt(x-1)=="\\");C=new this.String(z);C.set("imp",z.indexOf("|",++x)+1);C.set("sString",z.slice(0,x));break;case "$":k=z.indexOf("|");x=(-1<k)?k++:z.length;C=new this.Variable(z);C.set("imp",k);C.set("name",z.slice(1,x));break;case "/":o=this.toUcfirst(R.setTree(z.slice(1),true));a=this.toUcfirst(R.typeOf(o.toLowerCase()));C=(o in this)?new this[o](z):new this[a](z);break;default:Z=z.indexOf(" ");k=z.indexOf("|");x=(-1<Z)?Z++:(-1<k)?k++:z.length;o=this.toUcfirst(R.setTree(z.slice(0,x),false));a=this.toUcfirst(R.typeOf(o.toLowerCase()));C=(o in this)?new this[o](z):new this[a](z);C.set("iap",Z);C.set("imp",k);C.set("bTerminal",false);C.set("name",o.toLowerCase());break;}if(S&&R.isPlain()){C=new this.Plainm(z);}C.parse(R);return C;};JSmarty.Compiler.VALSYMBL="@@COMPILER::VARIABLE@@";JSmarty.Compiler.FNCSYMBL="@@COMPILER::FUNCTION@@";JSmarty.Compiler.MODSYMBL="@@COMPILER::MODIFIER@@";JSmarty.Compiler.toUcfirst=function(k){return k.slice(0,1).toUpperCase().concat(k.slice(1));};JSmarty.Compiler.Context=function(){};JSmarty.Compiler.Context.prototype={_tags:[],_blocks:{},_plains:{strip:true,literal:true,javascript:true},iPlain:-1,ldelim:"{",rdelim:"}",className:"Context",set:function(k,o){this[k]=o;},get:function(k){return this[k];},setTree:function(C,o){var k=this._tags,Z=this._plains;if(C in this._blocks){if(o){if(C!=k.pop()){this._error();}if(C in Z&&this.iPlain==k.length){this.iPlain=-1;}}else{k.push(C);if(C in Z&&this.iPlain==-1){this.iPlain=k.length-1;}}}return C;},isPlain:function(){return (0<=this.iPlain);},addElement:function(k,o){switch(k){case "block":this._blocks[o]=true;break;case "plain":this._plains[o]=true;break;}},typeOf:function(k){if(k in this._blocks){return "block";}return "function";}};JSmarty.Compiler.Module=function(){};JSmarty.Compiler.Module.prototype={imp:-1,iap:-1,name:null,text:null,sPrefix:"$b.append(",sSuffix:");",sString:null,bTerminal:true,parse:function(k){},prefix:function(){return this.sPrefix;},suffix:function(){return this.sSuffix;},isTerminal:function(){return this.bTerminal;},toModify:function(){if(this.imp<0){return "{}";}var o,C,d=false;var k=JSmarty.Compiler.VALSYMBL;var Z=this.text.slice(this.imp).split("");for(o=0,C=Z.length;o<=C;o++){switch(Z[o]){case "$":Z[o]=k;break;case "\"":case "'":d=Z[o++];while(Z[o]!=d&&o<=C){o++;}if(C+1<o){this._error();}if(Z[o-1]=="\\"){o--;}break;case ":":Z[o]=(d)?",":"\":[,";d=true;break;case "|":Z[o]=(d)?"],\"":"\":[],\"";d=false;break;}}Z[o]=(d)?"":"\":[";return "{\""+Z.join("")+"]}";},toParams:function(){if(this.iap<0){return "{}";}var o,d,C;var k=JSmarty.Compiler.VALSYMBL;var Z=this.text.slice(this.iap).split("");outerloop:for(o=0,C=Z.length;o<=C;o++){switch(Z[o]){case "$":Z[o]=k;break;case "=":Z[o]=":";break;case " ":case "\t":case "\r":case "\n":Z[o++]=",";while(Z[o]<=" "){Z[o++]="";}break;case "\"":case "'":d=Z[o++];while(Z[o]!=d&&o<=C){++o;}if(C<o){this._error();}if(Z[o-1]=="\\"){o--;}break;case "|":Z.splice(o);this.imp=this.iap+o+1;breakouterloop;}}return "{"+Z.join("")+"}";},toObject:function(){var k=/([^:,]+):('|"|)([^,]+)\2/g;return function(Z){var C,d={};Z=Z.slice(1,Z.length-1);while((C=k.exec(Z))!=null){d[C[1]]=C[3];}return d;};}(),getText:function(){return this.escape(this.text);},getName:function(){return this.quote(this.name);},quote:function(k){return (k)?"'"+k+"'":"";},escape:function(k){return (k.indexOf("'")==-1)?k:k.split("'").join("\\'");},toString:function(){return this.sString;},set:function(k,o){this[k]=o;},get:function(k){return this[k];}};JSmarty.Compiler.define("Module",{String:{sString:"",parse:function(Z){if(this.sString==""){this.sString=this.quote(this.getText());return ;}if(this.sString!=""){var k=this.toModify();var o=this.escape(this.sString);this.sString="$.$m("+k+","+o+")";return ;}this.sPrefix="";this.sSuffix="";return this;}},Variable:{parse:function(Z){var k=this.toModify();var o=JSmarty.Compiler.VALSYMBL+this.get("name");this.sString="$.$m("+k+","+o+")";}},Plains:{sPrefix:"",sSuffix:"",sString:"",parse:function(k){this.sString=this.getText();}},Plainm:{parse:function(k){this.sPrefix=k.get("ldelim");this.sSuffix=k.get("rdelim");this.sString=this.getText();}},Block:{parse:function(k){if(this.isTerminal()){this.sPrefix="";this.sString="return $b.toString();}())";return ;}this.sSuffix="function(){var $b = new Buffer();";this.sString="$.$p("+this.getName()+","+this.toParams()+","+this.toModify()+",";},genString:function(){}},Function:{parse:function(k){this.sString="$.$p("+this.getName()+","+this.toParams()+","+this.toModify()+")";}},Ldelim:{sString:"$.left_delimiter"},Rdelim:{sString:"$.right_delimiter"},If:{sSuffix:"",sPrefix:"",OPERATORS:{eq:"==",ne:"!=",neq:"!=",gt:">",lt:"<",ge:">=",gte:">=",le:"<=",lte:"<=",not:"!",and:"&&",or:"||",mod:"%"},parse:function(k){if(this.isTerminal()){this.sString="}\n";return ;}this.sString="if("+this.toExpression()+"){";},toExpression:function(){var k=this.get("iap"),R=this.OPERATORS;var o,C,d,Z=this.text.slice(this.iap).split("");outerloop:for(o=0,C=Z.length;o<=C;o++){switch(Z[o]){case "$":Z[o++]=JSmarty.Compiler.VALSYMBL;break;case "\"":case "'":d=Z[o++];while(Z[o]!=d&&o<=C){++o;}if(C+1<o){this._error();}if(Z[o-1]=="\\"){o--;}break;case " ":d="";while(Z[++o]!=" "&&o<=C){d+=Z[o],Z[o]="";}if(C+1<o){this._error();}Z[o]=((R[d])?R[d]:d)+" ";break;case "|":Z.splice(o);breakouterloop;}}return Z.join("");}},Else:{sPrefix:"",sSuffix:"",sString:"}else{"},Literal:{sPrefix:"",sSuffix:"",sString:"'));",parse:function(o){if(!this.isTerminal()){var k=this.toModify();this.sPrefix="$b.append(";this.sString="$.$m("+k+","+"'";}}},Foreach:{sSuffix:"",parse:function(Z){if(this.isTerminal()){this.sPrefix="";this.sString="};return $b.toString();}()));";return ;}var k=new JSmarty.Classes.Buffer();var o=this.toObject(this.toParams());k.append("$.$m(",this.toModify(),",","function(){var $b = new Buffer();");k.appendIf(o.name)("$.$foreach.",o.name,"={total:0,index:-1,iteration:0};","var $f=$.$foreach.",o.name,";","$f.first=true,$f.last=false;","for(var k in ",o.from,"){$f.total++;};");k.append("for(var k in ",o.from,"){");k.appendIf(o.key)("$v.",o.key,"=k;");k.appendIf(o.item)("$v.",o.item,"=",o.from,"[k];");k.appendIf(o.name)("$f.index++, $f.iteration++;","$f.first=($f.index==0), $f.last=($f.iteration==$f.total);");this.sString=k.toString("\n");}},Foreachelse:{sPrefix:"",sSuffix:"",sString:"}; if(!k){"},Section:{sSuffix:"",parse:function(x){if(this.isTerminal()){this.sPrefix="";this.sString="};return $b.toString();}()));";return ;}var d=this.toObject(this.toParams());var C,o=d.name||"i";var Z=JSmarty.Classes("Buffer");var R=JSmarty.Classes("Buffer");R.append(o,"=",d.start||0);R.append(o,"<=",d.max||isNaN(Number(d.loop))?d.loop+".length-1":d.loop);R.append(o,"+=",d.step||1);Z.append("$.$m(",this.toModify(),",","function(){var ",o,", $b = new Buffer();");Z.appendIf(d.name)("$.$section.",d.name,"={total:0,index:-1,iteration:0};","var $l=$.$section.",d.name,";","$l.first=true,$l.last=false;","for(",R.toString(";"),"){$l.total++;};");Z.append("for(",R.toString(";"),"){");Z.appendIf(d.name)("$l.index++, $l.rownum = $l.iteration++;","$l.first=($l.index==0), $l.last=($l.iteration==$l.total);");this.sString=Z.toString("\n");}},Sectionelse:{sPrefix:"",sSuffix:"",sString:"}; if(!$l.total){"}});JSmarty.Compiler.define("If",{Elseif:{parse:function(k){this.sString="}else if("+this.toExpression()+"){";}}});JSmarty.Compiler.define("Literal",{Strip:{sString:"').replace(/\\n/g,'')));",parse:function(k){this.parent.parse.call(this,k);if(!this.isTerminal()){this.sString+="'+('";}}}});